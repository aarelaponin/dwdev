# ============================================================================
# MTCA Forms - Priority 3C: VAT Registration & Article 10 Returns
# Forms: VAT Online Form 1-4, VAT Return Art 10, Recapitulative Statement, Intrastat
# Version: 1.0
# Date: 2025-12-06
# Purpose: ORS Database Schema Design and Informix Data Migration
# ============================================================================

forms:
  # ==========================================================================
  # VAT Online Form 1: VAT Registration (Article 10)
  # ==========================================================================
  - form:
      metadata:
        form_code: "VAT_FORM_1"
        form_name_en: "VAT Registration - Article 10 (Taxable Persons)"
        form_name_mt: "ReÄ¡istrazzjoni VAT - Artikolu 10 (Persuni Taxabbli)"
        version: "2024"
        effective_from: "2018-01-01"
        effective_to: "current"
        legislative_basis: "VAT Act Cap. 406"
        subsidiary_legislation:
          - "S.L.406.01 - VAT (Registration) Regulations"
        administering_authority: "CFR"
        tax_type: "VAT"
        taxpayer_category: "Taxable Person"
        filing_frequency: "One-time"
        filing_deadline: "Before making taxable supplies"
        submission_method: "Electronic"
        electronic_portal: "CFR e-Services"
        source_url: "https://cfr.gov.mt/en/vat/Pages/VAT-Registration.aspx"
        pdf_available: false
        online_form_available: true
        xml_schema_ref: null
        notes: |
          Registration for taxable persons making taxable supplies in Malta.
          Required when turnover exceeds or is expected to exceed thresholds.
          Mandatory for intra-Community acquisitions exceeding â‚¬10,000.
          E-ID authentication required for online submission.

      sections:
        - section_id: "APPLICANT_ID"
          section_name: "Applicant Identification"
          section_description: "Details of person/entity registering for VAT"
          repeatable: false
          conditional: false
          condition_logic: null
          fields:
            - field_id: "applicant_tin"
              field_code: "Box 1"
              field_name_en: "Tax Identification Number"
              field_name_mt: "Numru ta' Identifikazzjoni tat-Taxxa"
              field_description: "Applicant's TIN (individual ID or 9-digit)"
              data_type: "TIN"
              format: "0000000X or 999999999"
              max_length: 9
              precision: null
              scale: null
              required: true
              required_condition: null
              editable: false
              default_value: null
              calculated: false
              calculation_formula: null
              validation_rules:
                - rule_id: "VAT1_001"
                  rule_type: "pattern"
                  rule_description: "Valid TIN format"
                  rule_expression: "^([0-9]{7}[A-Z]|[0-9]{9})$"
                  error_message_en: "Invalid TIN format"
                  error_message_mt: "Format tat-TIN mhux validu"
                  severity: "error"
              allowed_values: []
              reference_table: "taxpayer_register"
              cross_form_reference: null
              legacy_mapping:
                database: "vat_db"
                table: "vat_registration"
                column: "applicant_tin"
              ors_mapping:
                table: "mtca_ors.vat_registration"
                column: "applicant_tin"
                data_type: "String"

            - field_id: "legal_name"
              field_code: "Box 2"
              field_name_en: "Legal Name"
              field_name_mt: "Isem Legali"
              field_description: "Full legal name of applicant"
              data_type: "STRING"
              format: null
              max_length: 200
              precision: null
              scale: null
              required: true
              required_condition: null
              editable: true
              default_value: null
              calculated: false
              calculation_formula: null
              validation_rules: []
              allowed_values: []
              reference_table: null
              cross_form_reference: null
              legacy_mapping:
                database: "vat_db"
                table: "vat_registration"
                column: "legal_name"
              ors_mapping:
                table: "mtca_ors.vat_registration"
                column: "legal_name"
                data_type: "String"

            - field_id: "entity_type"
              field_code: "Box 3"
              field_name_en: "Entity Type"
              field_name_mt: "Tip ta' EntitÃ "
              field_description: "Legal form of entity"
              data_type: "CODE"
              format: null
              max_length: 3
              precision: null
              scale: null
              required: true
              required_condition: null
              editable: true
              default_value: null
              calculated: false
              calculation_formula: null
              validation_rules: []
              allowed_values:
                - code: "IND"
                  description_en: "Individual/Sole Trader"
                  description_mt: "Individwu/Negozjant Uniku"
                - code: "LTD"
                  description_en: "Limited Company"
                  description_mt: "Kumpanija Limitata"
                - code: "PRT"
                  description_en: "Partnership"
                  description_mt: "SÄ§ubija"
                - code: "BRN"
                  description_en: "Branch"
                  description_mt: "FergÄ§a"
                - code: "OTH"
                  description_en: "Other"
                  description_mt: "OÄ§ra"
              reference_table: "entity_type_codes"
              cross_form_reference: null
              legacy_mapping:
                database: "vat_db"
                table: "vat_registration"
                column: "entity_type"
              ors_mapping:
                table: "mtca_ors.vat_registration"
                column: "entity_type"
                data_type: "FixedString(3)"

        - section_id: "BUSINESS_ACTIVITY"
          section_name: "Business Activity"
          section_description: "Economic activity details"
          repeatable: false
          conditional: false
          condition_logic: null
          fields:
            - field_id: "nace_code"
              field_code: "Box 10"
              field_name_en: "NACE Activity Code"
              field_name_mt: "KodiÄ‹i tal-AttivitÃ  NACE"
              field_description: "Statistical classification of economic activity"
              data_type: "STRING"
              format: "##.##"
              max_length: 5
              precision: null
              scale: null
              required: true
              required_condition: null
              editable: true
              default_value: null
              calculated: false
              calculation_formula: null
              validation_rules: []
              allowed_values: []
              reference_table: "nace_codes"
              cross_form_reference: null
              legacy_mapping:
                database: "vat_db"
                table: "vat_registration"
                column: "nace_code"
              ors_mapping:
                table: "mtca_ors.vat_registration"
                column: "nace_code"
                data_type: "String"

            - field_id: "activity_description"
              field_code: "Box 11"
              field_name_en: "Activity Description"
              field_name_mt: "Deskrizzjoni tal-AttivitÃ "
              field_description: "Description of business activities"
              data_type: "STRING"
              format: null
              max_length: 1000
              precision: null
              scale: null
              required: true
              required_condition: null
              editable: true
              default_value: null
              calculated: false
              calculation_formula: null
              validation_rules: []
              allowed_values: []
              reference_table: null
              cross_form_reference: null
              legacy_mapping:
                database: "vat_db"
                table: "vat_registration"
                column: "activity_description"
              ors_mapping:
                table: "mtca_ors.vat_registration"
                column: "activity_description"
                data_type: "String"

            - field_id: "commencement_date"
              field_code: "Box 12"
              field_name_en: "Commencement Date"
              field_name_mt: "Data tal-Bidu"
              field_description: "Date when taxable activity commenced/will commence"
              data_type: "DATE"
              format: "YYYY-MM-DD"
              max_length: 10
              precision: null
              scale: null
              required: true
              required_condition: null
              editable: true
              default_value: null
              calculated: false
              calculation_formula: null
              validation_rules: []
              allowed_values: []
              reference_table: null
              cross_form_reference: null
              legacy_mapping:
                database: "vat_db"
                table: "vat_registration"
                column: "commencement_date"
              ors_mapping:
                table: "mtca_ors.vat_registration"
                column: "commencement_date"
                data_type: "Date"

            - field_id: "expected_turnover"
              field_code: "Box 13"
              field_name_en: "Expected Annual Turnover"
              field_name_mt: "Fatturat Annwali Mistenni"
              field_description: "Estimated turnover for first 12 months"
              data_type: "CURRENCY_EUR"
              format: "â‚¬###,###,###.00"
              max_length: null
              precision: 15
              scale: 2
              required: true
              required_condition: null
              editable: true
              default_value: null
              calculated: false
              calculation_formula: null
              validation_rules: []
              allowed_values: []
              reference_table: null
              cross_form_reference: null
              legacy_mapping:
                database: "vat_db"
                table: "vat_registration"
                column: "expected_turnover"
              ors_mapping:
                table: "mtca_ors.vat_registration"
                column: "expected_turnover"
                data_type: "Decimal(15,2)"

        - section_id: "REGISTRATION_OPTIONS"
          section_name: "Registration Options"
          section_description: "VAT registration type selection"
          repeatable: false
          conditional: false
          condition_logic: null
          fields:
            - field_id: "registration_reason"
              field_code: "Box 20"
              field_name_en: "Registration Reason"
              field_name_mt: "RaÄ¡uni gÄ§ar-ReÄ¡istrazzjoni"
              field_description: "Reason for VAT registration"
              data_type: "CODE"
              format: null
              max_length: 3
              precision: null
              scale: null
              required: true
              required_condition: null
              editable: true
              default_value: null
              calculated: false
              calculation_formula: null
              validation_rules: []
              allowed_values:
                - code: "MAN"
                  description_en: "Mandatory - Exceeded Threshold"
                  description_mt: "Obbligatorju - QbiÅ¼t il-Limitu"
                - code: "VOL"
                  description_en: "Voluntary Registration"
                  description_mt: "ReÄ¡istrazzjoni Volontarja"
                - code: "ICA"
                  description_en: "Intra-Community Acquisitions"
                  description_mt: "Akkwisti Intra-Komunitarji"
              reference_table: "registration_reason_codes"
              cross_form_reference: null
              legacy_mapping:
                database: "vat_db"
                table: "vat_registration"
                column: "registration_reason"
              ors_mapping:
                table: "mtca_ors.vat_registration"
                column: "registration_reason"
                data_type: "FixedString(3)"

            - field_id: "return_period"
              field_code: "Box 21"
              field_name_en: "VAT Return Period"
              field_name_mt: "Perjodu tar-Return VAT"
              field_description: "Quarterly or Monthly returns"
              data_type: "CODE"
              format: null
              max_length: 1
              precision: null
              scale: null
              required: true
              required_condition: null
              editable: true
              default_value: "Q"
              calculated: false
              calculation_formula: null
              validation_rules: []
              allowed_values:
                - code: "Q"
                  description_en: "Quarterly"
                  description_mt: "Kull Tliet Xhur"
                - code: "M"
                  description_en: "Monthly"
                  description_mt: "Kull Xahar"
              reference_table: null
              cross_form_reference: null
              legacy_mapping:
                database: "vat_db"
                table: "vat_registration"
                column: "return_period"
              ors_mapping:
                table: "mtca_ors.vat_registration"
                column: "return_period"
                data_type: "FixedString(1)"

      attachments:
        - attachment_code: "ID_DOCS"
          attachment_name: "Identity Documents"
          required: true
          required_condition: null
          max_file_size_mb: 10
          allowed_formats:
            - "PDF"
            - "PNG"
            - "JPG"

      related_forms:
        - form_code: "VAT_RETURN"
          relationship_type: "triggers"
          relationship_description: "Registration triggers periodic VAT returns"

      submission_workflow:
        authentication_required: "e-ID Level 2"
        signature_required: false
        payment_integration: false
        acknowledgment_type: "VAT number issued upon approval"

  # ==========================================================================
  # VAT Online Form 2: Small Undertakings (Article 11)
  # ==========================================================================
  - form:
      metadata:
        form_code: "VAT_FORM_2"
        form_name_en: "VAT Registration - Article 11 (Small Undertakings)"
        form_name_mt: "ReÄ¡istrazzjoni VAT - Artikolu 11 (ImpriÅ¼i Å»gÄ§ar)"
        version: "2024"
        effective_from: "2018-01-01"
        effective_to: "current"
        legislative_basis: "VAT Act Cap. 406"
        subsidiary_legislation:
          - "S.L.406.01 - VAT (Registration) Regulations"
        administering_authority: "CFR"
        tax_type: "VAT"
        taxpayer_category: "Small Undertaking"
        filing_frequency: "One-time"
        filing_deadline: "Before making taxable supplies"
        submission_method: "Electronic"
        electronic_portal: "CFR e-Services"
        source_url: "https://cfr.gov.mt/en/vat/Pages/VAT-Registration.aspx"
        pdf_available: false
        online_form_available: true
        xml_schema_ref: null
        notes: |
          For small undertakings with turnover not exceeding â‚¬30,000 annually.
          Exempt from charging VAT but cannot recover input VAT. Annual
          declaration only. Must monitor turnover threshold.

      sections:
        - section_id: "APPLICANT_ID"
          section_name: "Applicant Identification"
          section_description: "Small undertaking details"
          repeatable: false
          conditional: false
          condition_logic: null
          fields:
            - field_id: "applicant_tin"
              field_code: "Box 1"
              field_name_en: "Tax Identification Number"
              field_name_mt: "Numru ta' Identifikazzjoni tat-Taxxa"
              field_description: "Applicant's TIN"
              data_type: "TIN"
              format: "0000000X or 999999999"
              max_length: 9
              precision: null
              scale: null
              required: true
              required_condition: null
              editable: false
              default_value: null
              calculated: false
              calculation_formula: null
              validation_rules:
                - rule_id: "VAT2_001"
                  rule_type: "pattern"
                  rule_description: "Valid TIN format"
                  rule_expression: "^([0-9]{7}[A-Z]|[0-9]{9})$"
                  error_message_en: "Invalid TIN format"
                  error_message_mt: "Format tat-TIN mhux validu"
                  severity: "error"
              allowed_values: []
              reference_table: "taxpayer_register"
              cross_form_reference: null
              legacy_mapping:
                database: "vat_db"
                table: "vat_art11_registration"
                column: "applicant_tin"
              ors_mapping:
                table: "mtca_ors.vat_art11_registration"
                column: "applicant_tin"
                data_type: "String"

            - field_id: "expected_turnover"
              field_code: "Box 10"
              field_name_en: "Expected Annual Turnover"
              field_name_mt: "Fatturat Annwali Mistenni"
              field_description: "Estimated turnover - must not exceed â‚¬30,000"
              data_type: "CURRENCY_EUR"
              format: "â‚¬###,###,###.00"
              max_length: null
              precision: 15
              scale: 2
              required: true
              required_condition: null
              editable: true
              default_value: null
              calculated: false
              calculation_formula: null
              validation_rules:
                - rule_id: "VAT2_010"
                  rule_type: "range"
                  rule_description: "Must not exceed â‚¬30,000"
                  rule_expression: "expected_turnover <= 30000"
                  error_message_en: "Exceeds Article 11 threshold - use Form 1"
                  error_message_mt: "JaqbeÅ¼ il-limitu tal-Artikolu 11 - uÅ¼a Formola 1"
                  severity: "error"
              allowed_values: []
              reference_table: null
              cross_form_reference: null
              legacy_mapping:
                database: "vat_db"
                table: "vat_art11_registration"
                column: "expected_turnover"
              ors_mapping:
                table: "mtca_ors.vat_art11_registration"
                column: "expected_turnover"
                data_type: "Decimal(15,2)"

      attachments: []

      related_forms:
        - form_code: "VAT_FORM_1"
          relationship_type: "alternative"
          relationship_description: "Use if exceeding â‚¬30,000 threshold"

      submission_workflow:
        authentication_required: "e-ID Level 2"
        signature_required: false
        payment_integration: false
        acknowledgment_type: "Article 11 registration confirmation"

  # ==========================================================================
  # VAT Return (Article 10)
  # ==========================================================================
  - form:
      metadata:
        form_code: "VAT_RETURN_ART10"
        form_name_en: "Periodic VAT Return (Article 10)"
        form_name_mt: "Return Perjodiku tal-VAT (Artikolu 10)"
        version: "2024"
        effective_from: "2023-02-01"
        effective_to: "current"
        legislative_basis: "VAT Act Cap. 406"
        subsidiary_legislation:
          - "S.L.406.15 - VAT (Returns) Regulations"
        administering_authority: "CFR"
        tax_type: "VAT"
        taxpayer_category: "Article 10 Registered Person"
        filing_frequency: "Quarterly/Monthly"
        filing_deadline: "6 weeks after period end"
        submission_method: "Electronic-only"
        electronic_portal: "CFR e-Services"
        source_url: "https://cfr.gov.mt/en/vat/Pages/VAT-Returns.aspx"
        pdf_available: false
        online_form_available: true
        xml_schema_ref: "VAT_RETURN_XML_v2024"
        notes: |
          Mandatory electronic filing since February 2023. Quarterly for most,
          monthly option available. Declares output VAT, input VAT, and net
          payable/refundable. Includes domestic, EU, and export supplies.

      sections:
        - section_id: "RETURN_PERIOD"
          section_name: "Return Period"
          section_description: "VAT period identification"
          repeatable: false
          conditional: false
          condition_logic: null
          fields:
            - field_id: "vat_number"
              field_code: "Box 1"
              field_name_en: "VAT Registration Number"
              field_name_mt: "Numru ta' ReÄ¡istrazzjoni VAT"
              field_description: "Malta VAT number (MT########)"
              data_type: "STRING"
              format: "MT########"
              max_length: 10
              precision: null
              scale: null
              required: true
              required_condition: null
              editable: false
              default_value: null
              calculated: false
              calculation_formula: null
              validation_rules:
                - rule_id: "VATR_001"
                  rule_type: "pattern"
                  rule_description: "Valid Malta VAT format"
                  rule_expression: "^MT[0-9]{8}$"
                  error_message_en: "Invalid VAT number format"
                  error_message_mt: "Format tan-numru VAT mhux validu"
                  severity: "error"
              allowed_values: []
              reference_table: "vat_register"
              cross_form_reference: null
              legacy_mapping:
                database: "vat_db"
                table: "vat_return"
                column: "vat_number"
              ors_mapping:
                table: "mtca_ors.vat_return"
                column: "vat_number"
                data_type: "FixedString(10)"

            - field_id: "period_from"
              field_code: "Box 2"
              field_name_en: "Period From"
              field_name_mt: "Perjodu Minn"
              field_description: "Start date of VAT period"
              data_type: "DATE"
              format: "YYYY-MM-DD"
              max_length: 10
              precision: null
              scale: null
              required: true
              required_condition: null
              editable: false
              default_value: null
              calculated: false
              calculation_formula: null
              validation_rules: []
              allowed_values: []
              reference_table: null
              cross_form_reference: null
              legacy_mapping:
                database: "vat_db"
                table: "vat_return"
                column: "period_from"
              ors_mapping:
                table: "mtca_ors.vat_return"
                column: "period_from"
                data_type: "Date"

            - field_id: "period_to"
              field_code: "Box 3"
              field_name_en: "Period To"
              field_name_mt: "Perjodu Sa"
              field_description: "End date of VAT period"
              data_type: "DATE"
              format: "YYYY-MM-DD"
              max_length: 10
              precision: null
              scale: null
              required: true
              required_condition: null
              editable: false
              default_value: null
              calculated: false
              calculation_formula: null
              validation_rules: []
              allowed_values: []
              reference_table: null
              cross_form_reference: null
              legacy_mapping:
                database: "vat_db"
                table: "vat_return"
                column: "period_to"
              ors_mapping:
                table: "mtca_ors.vat_return"
                column: "period_to"
                data_type: "Date"

        - section_id: "OUTPUT_VAT"
          section_name: "Output VAT"
          section_description: "VAT charged on supplies"
          repeatable: false
          conditional: false
          condition_logic: null
          fields:
            - field_id: "domestic_supplies_standard"
              field_code: "Box 10"
              field_name_en: "Domestic Supplies at Standard Rate"
              field_name_mt: "Provvisti DomestiÄ‹i bir-Rata Standard"
              field_description: "Taxable value of domestic supplies at 18%"
              data_type: "CURRENCY_EUR"
              format: "â‚¬###,###,###.00"
              max_length: null
              precision: 15
              scale: 2
              required: true
              required_condition: null
              editable: true
              default_value: 0
              calculated: false
              calculation_formula: null
              validation_rules: []
              allowed_values: []
              reference_table: null
              cross_form_reference: null
              legacy_mapping:
                database: "vat_db"
                table: "vat_return"
                column: "domestic_standard"
              ors_mapping:
                table: "mtca_ors.vat_return"
                column: "domestic_supplies_standard"
                data_type: "Decimal(15,2)"

            - field_id: "vat_standard_rate"
              field_code: "Box 11"
              field_name_en: "VAT at 18%"
              field_name_mt: "VAT b'18%"
              field_description: "Output VAT at standard 18% rate"
              data_type: "CURRENCY_EUR"
              format: "â‚¬###,###,###.00"
              max_length: null
              precision: 15
              scale: 2
              required: true
              required_condition: null
              editable: false
              default_value: null
              calculated: true
              calculation_formula: "domestic_supplies_standard * 0.18"
              validation_rules: []
              allowed_values: []
              reference_table: null
              cross_form_reference: null
              legacy_mapping:
                database: "vat_db"
                table: "vat_return"
                column: "vat_standard"
              ors_mapping:
                table: "mtca_ors.vat_return"
                column: "vat_standard_rate"
                data_type: "Decimal(15,2)"

            - field_id: "domestic_supplies_reduced"
              field_code: "Box 12"
              field_name_en: "Domestic Supplies at Reduced Rate"
              field_name_mt: "Provvisti DomestiÄ‹i bir-Rata Mnaqqsa"
              field_description: "Taxable value at reduced rates (7%/5%)"
              data_type: "CURRENCY_EUR"
              format: "â‚¬###,###,###.00"
              max_length: null
              precision: 15
              scale: 2
              required: true
              required_condition: null
              editable: true
              default_value: 0
              calculated: false
              calculation_formula: null
              validation_rules: []
              allowed_values: []
              reference_table: null
              cross_form_reference: null
              legacy_mapping:
                database: "vat_db"
                table: "vat_return"
                column: "domestic_reduced"
              ors_mapping:
                table: "mtca_ors.vat_return"
                column: "domestic_supplies_reduced"
                data_type: "Decimal(15,2)"

            - field_id: "vat_reduced_rate"
              field_code: "Box 13"
              field_name_en: "VAT at Reduced Rates"
              field_name_mt: "VAT b'Rati Mnaqqsin"
              field_description: "Output VAT at reduced rates"
              data_type: "CURRENCY_EUR"
              format: "â‚¬###,###,###.00"
              max_length: null
              precision: 15
              scale: 2
              required: true
              required_condition: null
              editable: true
              default_value: 0
              calculated: false
              calculation_formula: null
              validation_rules: []
              allowed_values: []
              reference_table: null
              cross_form_reference: null
              legacy_mapping:
                database: "vat_db"
                table: "vat_return"
                column: "vat_reduced"
              ors_mapping:
                table: "mtca_ors.vat_return"
                column: "vat_reduced_rate"
                data_type: "Decimal(15,2)"

            - field_id: "exempt_supplies"
              field_code: "Box 14"
              field_name_en: "Exempt Supplies"
              field_name_mt: "Provvisti EÅ¼entati"
              field_description: "Value of VAT-exempt supplies"
              data_type: "CURRENCY_EUR"
              format: "â‚¬###,###,###.00"
              max_length: null
              precision: 15
              scale: 2
              required: true
              required_condition: null
              editable: true
              default_value: 0
              calculated: false
              calculation_formula: null
              validation_rules: []
              allowed_values: []
              reference_table: null
              cross_form_reference: null
              legacy_mapping:
                database: "vat_db"
                table: "vat_return"
                column: "exempt_supplies"
              ors_mapping:
                table: "mtca_ors.vat_return"
                column: "exempt_supplies"
                data_type: "Decimal(15,2)"

            - field_id: "intra_community_supplies"
              field_code: "Box 15"
              field_name_en: "Intra-Community Supplies"
              field_name_mt: "Provvisti Intra-Komunitarji"
              field_description: "Zero-rated B2B supplies to other EU states"
              data_type: "CURRENCY_EUR"
              format: "â‚¬###,###,###.00"
              max_length: null
              precision: 15
              scale: 2
              required: true
              required_condition: null
              editable: true
              default_value: 0
              calculated: false
              calculation_formula: null
              validation_rules: []
              allowed_values: []
              reference_table: null
              cross_form_reference: "RECAPITULATIVE_STATEMENT"
              legacy_mapping:
                database: "vat_db"
                table: "vat_return"
                column: "ic_supplies"
              ors_mapping:
                table: "mtca_ors.vat_return"
                column: "intra_community_supplies"
                data_type: "Decimal(15,2)"

            - field_id: "exports"
              field_code: "Box 16"
              field_name_en: "Exports to Non-EU"
              field_name_mt: "Esportazzjonijiet Barra mill-UE"
              field_description: "Zero-rated exports outside EU"
              data_type: "CURRENCY_EUR"
              format: "â‚¬###,###,###.00"
              max_length: null
              precision: 15
              scale: 2
              required: true
              required_condition: null
              editable: true
              default_value: 0
              calculated: false
              calculation_formula: null
              validation_rules: []
              allowed_values: []
              reference_table: null
              cross_form_reference: null
              legacy_mapping:
                database: "vat_db"
                table: "vat_return"
                column: "exports"
              ors_mapping:
                table: "mtca_ors.vat_return"
                column: "exports"
                data_type: "Decimal(15,2)"

            - field_id: "total_output_vat"
              field_code: "Box 19"
              field_name_en: "Total Output VAT"
              field_name_mt: "VAT Output Totali"
              field_description: "Sum of all output VAT"
              data_type: "CURRENCY_EUR"
              format: "â‚¬###,###,###.00"
              max_length: null
              precision: 15
              scale: 2
              required: true
              required_condition: null
              editable: false
              default_value: null
              calculated: true
              calculation_formula: "vat_standard_rate + vat_reduced_rate + acquisition_vat"
              validation_rules: []
              allowed_values: []
              reference_table: null
              cross_form_reference: null
              legacy_mapping:
                database: "vat_db"
                table: "vat_return"
                column: "total_output"
              ors_mapping:
                table: "mtca_ors.vat_return"
                column: "total_output_vat"
                data_type: "Decimal(15,2)"

        - section_id: "INPUT_VAT"
          section_name: "Input VAT"
          section_description: "VAT recoverable on purchases"
          repeatable: false
          conditional: false
          condition_logic: null
          fields:
            - field_id: "domestic_purchases"
              field_code: "Box 20"
              field_name_en: "Domestic Purchases"
              field_name_mt: "Xirjiet DomestiÄ‹i"
              field_description: "VAT on domestic purchases"
              data_type: "CURRENCY_EUR"
              format: "â‚¬###,###,###.00"
              max_length: null
              precision: 15
              scale: 2
              required: true
              required_condition: null
              editable: true
              default_value: 0
              calculated: false
              calculation_formula: null
              validation_rules: []
              allowed_values: []
              reference_table: null
              cross_form_reference: null
              legacy_mapping:
                database: "vat_db"
                table: "vat_return"
                column: "input_domestic"
              ors_mapping:
                table: "mtca_ors.vat_return"
                column: "domestic_purchases"
                data_type: "Decimal(15,2)"

            - field_id: "intra_community_acquisitions"
              field_code: "Box 21"
              field_name_en: "Intra-Community Acquisitions"
              field_name_mt: "Akkwisti Intra-Komunitarji"
              field_description: "VAT on acquisitions from other EU states"
              data_type: "CURRENCY_EUR"
              format: "â‚¬###,###,###.00"
              max_length: null
              precision: 15
              scale: 2
              required: true
              required_condition: null
              editable: true
              default_value: 0
              calculated: false
              calculation_formula: null
              validation_rules: []
              allowed_values: []
              reference_table: null
              cross_form_reference: "INTRASTAT"
              legacy_mapping:
                database: "vat_db"
                table: "vat_return"
                column: "input_ic"
              ors_mapping:
                table: "mtca_ors.vat_return"
                column: "intra_community_acquisitions"
                data_type: "Decimal(15,2)"

            - field_id: "imports_vat"
              field_code: "Box 22"
              field_name_en: "VAT on Imports"
              field_name_mt: "VAT fuq Importazzjonijiet"
              field_description: "VAT paid on imports from non-EU"
              data_type: "CURRENCY_EUR"
              format: "â‚¬###,###,###.00"
              max_length: null
              precision: 15
              scale: 2
              required: true
              required_condition: null
              editable: true
              default_value: 0
              calculated: false
              calculation_formula: null
              validation_rules: []
              allowed_values: []
              reference_table: null
              cross_form_reference: null
              legacy_mapping:
                database: "vat_db"
                table: "vat_return"
                column: "input_imports"
              ors_mapping:
                table: "mtca_ors.vat_return"
                column: "imports_vat"
                data_type: "Decimal(15,2)"

            - field_id: "total_input_vat"
              field_code: "Box 29"
              field_name_en: "Total Deductible Input VAT"
              field_name_mt: "VAT Input Totali Deduttibbli"
              field_description: "Sum of all recoverable input VAT"
              data_type: "CURRENCY_EUR"
              format: "â‚¬###,###,###.00"
              max_length: null
              precision: 15
              scale: 2
              required: true
              required_condition: null
              editable: false
              default_value: null
              calculated: true
              calculation_formula: "domestic_purchases + intra_community_acquisitions + imports_vat"
              validation_rules: []
              allowed_values: []
              reference_table: null
              cross_form_reference: null
              legacy_mapping:
                database: "vat_db"
                table: "vat_return"
                column: "total_input"
              ors_mapping:
                table: "mtca_ors.vat_return"
                column: "total_input_vat"
                data_type: "Decimal(15,2)"

        - section_id: "NET_VAT"
          section_name: "Net VAT"
          section_description: "Net VAT payable or refundable"
          repeatable: false
          conditional: false
          condition_logic: null
          fields:
            - field_id: "net_vat_payable"
              field_code: "Box 30"
              field_name_en: "Net VAT Payable/(Refundable)"
              field_name_mt: "VAT Nett Pagabbli/(RifuÅ¼a)"
              field_description: "Output VAT minus Input VAT"
              data_type: "CURRENCY_EUR"
              format: "â‚¬###,###,###.00"
              max_length: null
              precision: 15
              scale: 2
              required: true
              required_condition: null
              editable: false
              default_value: null
              calculated: true
              calculation_formula: "total_output_vat - total_input_vat"
              validation_rules: []
              allowed_values: []
              reference_table: null
              cross_form_reference: null
              legacy_mapping:
                database: "vat_db"
                table: "vat_return"
                column: "net_vat"
              ors_mapping:
                table: "mtca_ors.vat_return"
                column: "net_vat_payable"
                data_type: "Decimal(15,2)"

      attachments: []

      related_forms:
        - form_code: "RECAPITULATIVE_STATEMENT"
          relationship_type: "linked"
          relationship_description: "IC supplies declared in recapitulative"
        - form_code: "INTRASTAT"
          relationship_type: "linked"
          relationship_description: "Physical goods movements"

      submission_workflow:
        authentication_required: "e-ID Level 2"
        signature_required: false
        payment_integration: true
        acknowledgment_type: "Submission receipt with payment reference"

  # ==========================================================================
  # Recapitulative Statement (EC Sales List)
  # ==========================================================================
  - form:
      metadata:
        form_code: "RECAPITULATIVE_STATEMENT"
        form_name_en: "Recapitulative Statement (EC Sales List)"
        form_name_mt: "Dikjarazzjoni Rikapitulattiva (Lista ta' BejgÄ§ UE)"
        version: "2024"
        effective_from: "2009-01-01"
        effective_to: "current"
        legislative_basis: "VAT Act Cap. 406"
        subsidiary_legislation:
          - "LN 363/2009"
        administering_authority: "CFR"
        tax_type: "VAT"
        taxpayer_category: "Article 10 Registered Person"
        filing_frequency: "Monthly/Quarterly"
        filing_deadline: "By end of following month"
        submission_method: "Electronic-only"
        electronic_portal: "CFR e-Services"
        source_url: "https://cfr.gov.mt/en/vat/Pages/Recapitulative-Statement.aspx"
        pdf_available: false
        online_form_available: true
        xml_schema_ref: "VIES_XML"
        notes: |
          Reports intra-Community supplies to VAT-registered businesses in other
          EU member states. Forms basis for VIES (VAT Information Exchange System).
          Monthly if supplies >â‚¬50,000 per quarter, otherwise quarterly.

      sections:
        - section_id: "SUPPLIER_ID"
          section_name: "Supplier Identification"
          section_description: "Malta VAT registered supplier"
          repeatable: false
          conditional: false
          condition_logic: null
          fields:
            - field_id: "vat_number"
              field_code: "Box 1"
              field_name_en: "VAT Registration Number"
              field_name_mt: "Numru ta' ReÄ¡istrazzjoni VAT"
              field_description: "Malta VAT number"
              data_type: "STRING"
              format: "MT########"
              max_length: 10
              precision: null
              scale: null
              required: true
              required_condition: null
              editable: false
              default_value: null
              calculated: false
              calculation_formula: null
              validation_rules:
                - rule_id: "RECAP_001"
                  rule_type: "pattern"
                  rule_description: "Valid Malta VAT format"
                  rule_expression: "^MT[0-9]{8}$"
                  error_message_en: "Invalid VAT number"
                  error_message_mt: "Numru VAT mhux validu"
                  severity: "error"
              allowed_values: []
              reference_table: "vat_register"
              cross_form_reference: null
              legacy_mapping:
                database: "vat_db"
                table: "recapitulative"
                column: "vat_number"
              ors_mapping:
                table: "mtca_ors.recapitulative_statement"
                column: "vat_number"
                data_type: "FixedString(10)"

            - field_id: "period_month"
              field_code: "Box 2"
              field_name_en: "Period Month"
              field_name_mt: "Xahar tal-Perjodu"
              field_description: "Reporting month"
              data_type: "INTEGER"
              format: "MM"
              max_length: 2
              precision: null
              scale: null
              required: true
              required_condition: null
              editable: false
              default_value: null
              calculated: false
              calculation_formula: null
              validation_rules: []
              allowed_values: []
              reference_table: null
              cross_form_reference: null
              legacy_mapping:
                database: "vat_db"
                table: "recapitulative"
                column: "period_month"
              ors_mapping:
                table: "mtca_ors.recapitulative_statement"
                column: "period_month"
                data_type: "UInt8"

            - field_id: "period_year"
              field_code: "Box 3"
              field_name_en: "Period Year"
              field_name_mt: "Sena tal-Perjodu"
              field_description: "Reporting year"
              data_type: "YEAR"
              format: "YYYY"
              max_length: 4
              precision: null
              scale: null
              required: true
              required_condition: null
              editable: false
              default_value: null
              calculated: false
              calculation_formula: null
              validation_rules: []
              allowed_values: []
              reference_table: null
              cross_form_reference: null
              legacy_mapping:
                database: "vat_db"
                table: "recapitulative"
                column: "period_year"
              ors_mapping:
                table: "mtca_ors.recapitulative_statement"
                column: "period_year"
                data_type: "UInt16"

        - section_id: "IC_SUPPLIES"
          section_name: "Intra-Community Supplies"
          section_description: "Details of supplies to each EU customer"
          repeatable: true
          conditional: false
          condition_logic: null
          fields:
            - field_id: "customer_vat_number"
              field_code: "Line - Col 1"
              field_name_en: "Customer VAT Number"
              field_name_mt: "Numru VAT tal-Klijent"
              field_description: "EU customer's VAT identification number"
              data_type: "STRING"
              format: null
              max_length: 14
              precision: null
              scale: null
              required: true
              required_condition: null
              editable: true
              default_value: null
              calculated: false
              calculation_formula: null
              validation_rules:
                - rule_id: "RECAP_010"
                  rule_type: "pattern"
                  rule_description: "Valid EU VAT number"
                  rule_expression: "^[A-Z]{2}[A-Z0-9]{2,12}$"
                  error_message_en: "Invalid EU VAT number format"
                  error_message_mt: "Format tan-numru VAT UE mhux validu"
                  severity: "error"
              allowed_values: []
              reference_table: null
              cross_form_reference: null
              legacy_mapping:
                database: "vat_db"
                table: "recapitulative_detail"
                column: "customer_vat"
              ors_mapping:
                table: "mtca_ors.recapitulative_detail"
                column: "customer_vat_number"
                data_type: "String"

            - field_id: "country_code"
              field_code: "Line - Col 2"
              field_name_en: "Country Code"
              field_name_mt: "KodiÄ‹i tal-PajjiÅ¼"
              field_description: "EU member state code"
              data_type: "CODE"
              format: null
              max_length: 2
              precision: null
              scale: null
              required: true
              required_condition: null
              editable: false
              default_value: null
              calculated: true
              calculation_formula: "SUBSTRING(customer_vat_number, 1, 2)"
              validation_rules: []
              allowed_values: []
              reference_table: "eu_country_codes"
              cross_form_reference: null
              legacy_mapping:
                database: "vat_db"
                table: "recapitulative_detail"
                column: "country_code"
              ors_mapping:
                table: "mtca_ors.recapitulative_detail"
                column: "country_code"
                data_type: "FixedString(2)"

            - field_id: "supply_value"
              field_code: "Line - Col 3"
              field_name_en: "Value of Supplies"
              field_name_mt: "Valur tal-Provvisti"
              field_description: "Total value of supplies to this customer"
              data_type: "CURRENCY_EUR"
              format: "â‚¬###,###,###.00"
              max_length: null
              precision: 15
              scale: 2
              required: true
              required_condition: null
              editable: true
              default_value: null
              calculated: false
              calculation_formula: null
              validation_rules:
                - rule_id: "RECAP_011"
                  rule_type: "range"
                  rule_description: "Must be positive"
                  rule_expression: "supply_value > 0"
                  error_message_en: "Supply value must be positive"
                  error_message_mt: "Valur tal-provvista irid ikun poÅ¼ittiv"
                  severity: "error"
              allowed_values: []
              reference_table: null
              cross_form_reference: null
              legacy_mapping:
                database: "vat_db"
                table: "recapitulative_detail"
                column: "supply_value"
              ors_mapping:
                table: "mtca_ors.recapitulative_detail"
                column: "supply_value"
                data_type: "Decimal(15,2)"

            - field_id: "supply_type"
              field_code: "Line - Col 4"
              field_name_en: "Supply Type"
              field_name_mt: "Tip ta' Provvista"
              field_description: "Type of supply (goods/services/triangular)"
              data_type: "CODE"
              format: null
              max_length: 1
              precision: null
              scale: null
              required: true
              required_condition: null
              editable: true
              default_value: "G"
              calculated: false
              calculation_formula: null
              validation_rules: []
              allowed_values:
                - code: "G"
                  description_en: "Goods"
                  description_mt: "OÄ¡Ä¡etti"
                - code: "S"
                  description_en: "Services"
                  description_mt: "Servizzi"
                - code: "T"
                  description_en: "Triangular Trade"
                  description_mt: "KummerÄ‹ Triangolari"
              reference_table: null
              cross_form_reference: null
              legacy_mapping:
                database: "vat_db"
                table: "recapitulative_detail"
                column: "supply_type"
              ors_mapping:
                table: "mtca_ors.recapitulative_detail"
                column: "supply_type"
                data_type: "FixedString(1)"

        - section_id: "TOTALS"
          section_name: "Totals"
          section_description: "Summary totals"
          repeatable: false
          conditional: false
          condition_logic: null
          fields:
            - field_id: "total_ic_supplies"
              field_code: "Box 20"
              field_name_en: "Total Intra-Community Supplies"
              field_name_mt: "Provvisti Intra-Komunitarji Totali"
              field_description: "Sum of all IC supplies"
              data_type: "CURRENCY_EUR"
              format: "â‚¬###,###,###.00"
              max_length: null
              precision: 15
              scale: 2
              required: true
              required_condition: null
              editable: false
              default_value: null
              calculated: true
              calculation_formula: "SUM(supply_value)"
              validation_rules:
                - rule_id: "RECAP_020"
                  rule_type: "cross-reference"
                  rule_description: "Must match VAT return IC supplies"
                  rule_expression: "total_ic_supplies = VAT_RETURN.intra_community_supplies"
                  error_message_en: "Does not match VAT return"
                  error_message_mt: "Ma jaqbilx mar-return VAT"
                  severity: "warning"
              allowed_values: []
              reference_table: null
              cross_form_reference: "VAT_RETURN_ART10.intra_community_supplies"
              legacy_mapping:
                database: "vat_db"
                table: "recapitulative"
                column: "total_supplies"
              ors_mapping:
                table: "mtca_ors.recapitulative_statement"
                column: "total_ic_supplies"
                data_type: "Decimal(15,2)"

      attachments: []

      related_forms:
        - form_code: "VAT_RETURN_ART10"
          relationship_type: "reconciliation"
          relationship_description: "IC supplies must match VAT return"

      submission_workflow:
        authentication_required: "e-ID Level 2"
        signature_required: false
        payment_integration: false
        acknowledgment_type: "Submission confirmation"

  # ==========================================================================
  # Intrastat Declaration
  # ==========================================================================
  - form:
      metadata:
        form_code: "INTRASTAT"
        form_name_en: "Intrastat Declaration"
        form_name_mt: "Dikjarazzjoni Intrastat"
        version: "2024"
        effective_from: "2018-01-01"
        effective_to: "current"
        legislative_basis: "VAT Act Cap. 406"
        subsidiary_legislation:
          - "Regulation (EC) No 638/2004"
        administering_authority: "NSO (National Statistics Office)"
        tax_type: "Statistical"
        taxpayer_category: "Traders with EU goods movement >â‚¬700/year"
        filing_frequency: "Monthly"
        filing_deadline: "10th working day of following month"
        submission_method: "Electronic-only"
        electronic_portal: "NSO Intrastat System"
        source_url: "https://nso.gov.mt/intrastat"
        pdf_available: false
        online_form_available: true
        xml_schema_ref: "INTRASTAT_XML"
        notes: |
          Monthly declaration of physical movement of goods between Malta
          and other EU member states. Separate declarations for Arrivals
          (imports from EU) and Dispatches (exports to EU). Required if
          annual trade exceeds â‚¬700.

      sections:
        - section_id: "TRADER_ID"
          section_name: "Trader Identification"
          section_description: "Declaring trader details"
          repeatable: false
          conditional: false
          condition_logic: null
          fields:
            - field_id: "vat_number"
              field_code: "Box 1"
              field_name_en: "VAT Number"
              field_name_mt: "Numru VAT"
              field_description: "Malta VAT number"
              data_type: "STRING"
              format: "MT########"
              max_length: 10
              precision: null
              scale: null
              required: true
              required_condition: null
              editable: false
              default_value: null
              calculated: false
              calculation_formula: null
              validation_rules:
                - rule_id: "INTRA_001"
                  rule_type: "pattern"
                  rule_description: "Valid Malta VAT format"
                  rule_expression: "^MT[0-9]{8}$"
                  error_message_en: "Invalid VAT number"
                  error_message_mt: "Numru VAT mhux validu"
                  severity: "error"
              allowed_values: []
              reference_table: "vat_register"
              cross_form_reference: null
              legacy_mapping:
                database: "intrastat_db"
                table: "declaration"
                column: "vat_number"
              ors_mapping:
                table: "mtca_ors.intrastat_declaration"
                column: "vat_number"
                data_type: "FixedString(10)"

            - field_id: "declaration_type"
              field_code: "Box 2"
              field_name_en: "Declaration Type"
              field_name_mt: "Tip ta' Dikjarazzjoni"
              field_description: "Arrivals or Dispatches"
              data_type: "CODE"
              format: null
              max_length: 1
              precision: null
              scale: null
              required: true
              required_condition: null
              editable: false
              default_value: null
              calculated: false
              calculation_formula: null
              validation_rules: []
              allowed_values:
                - code: "A"
                  description_en: "Arrivals"
                  description_mt: "Wassliet"
                - code: "D"
                  description_en: "Dispatches"
                  description_mt: "DispaÄ‹Ä‹i"
              reference_table: null
              cross_form_reference: null
              legacy_mapping:
                database: "intrastat_db"
                table: "declaration"
                column: "declaration_type"
              ors_mapping:
                table: "mtca_ors.intrastat_declaration"
                column: "declaration_type"
                data_type: "FixedString(1)"

            - field_id: "reference_month"
              field_code: "Box 3"
              field_name_en: "Reference Month"
              field_name_mt: "Xahar ta' Referenza"
              field_description: "Month of goods movement"
              data_type: "INTEGER"
              format: "MM"
              max_length: 2
              precision: null
              scale: null
              required: true
              required_condition: null
              editable: false
              default_value: null
              calculated: false
              calculation_formula: null
              validation_rules: []
              allowed_values: []
              reference_table: null
              cross_form_reference: null
              legacy_mapping:
                database: "intrastat_db"
                table: "declaration"
                column: "reference_month"
              ors_mapping:
                table: "mtca_ors.intrastat_declaration"
                column: "reference_month"
                data_type: "UInt8"

            - field_id: "reference_year"
              field_code: "Box 4"
              field_name_en: "Reference Year"
              field_name_mt: "Sena ta' Referenza"
              field_description: "Year of goods movement"
              data_type: "YEAR"
              format: "YYYY"
              max_length: 4
              precision: null
              scale: null
              required: true
              required_condition: null
              editable: false
              default_value: null
              calculated: false
              calculation_formula: null
              validation_rules: []
              allowed_values: []
              reference_table: null
              cross_form_reference: null
              legacy_mapping:
                database: "intrastat_db"
                table: "declaration"
                column: "reference_year"
              ors_mapping:
                table: "mtca_ors.intrastat_declaration"
                column: "reference_year"
                data_type: "UInt16"

        - section_id: "GOODS_ITEMS"
          section_name: "Goods Items"
          section_description: "Individual commodity line items"
          repeatable: true
          conditional: false
          condition_logic: null
          fields:
            - field_id: "cn_code"
              field_code: "Line - Col 1"
              field_name_en: "Combined Nomenclature Code"
              field_name_mt: "KodiÄ‹i tan-Nomenklatura Kombinata"
              field_description: "8-digit CN commodity code"
              data_type: "STRING"
              format: "########"
              max_length: 8
              precision: null
              scale: null
              required: true
              required_condition: null
              editable: true
              default_value: null
              calculated: false
              calculation_formula: null
              validation_rules:
                - rule_id: "INTRA_010"
                  rule_type: "pattern"
                  rule_description: "Valid 8-digit CN code"
                  rule_expression: "^[0-9]{8}$"
                  error_message_en: "Invalid CN code format"
                  error_message_mt: "Format tal-kodiÄ‹i CN mhux validu"
                  severity: "error"
              allowed_values: []
              reference_table: "cn_codes"
              cross_form_reference: null
              legacy_mapping:
                database: "intrastat_db"
                table: "declaration_item"
                column: "cn_code"
              ors_mapping:
                table: "mtca_ors.intrastat_item"
                column: "cn_code"
                data_type: "FixedString(8)"

            - field_id: "partner_country"
              field_code: "Line - Col 2"
              field_name_en: "Partner Member State"
              field_name_mt: "Stat Membru SieÄ§eb"
              field_description: "EU country of dispatch/destination"
              data_type: "CODE"
              format: null
              max_length: 2
              precision: null
              scale: null
              required: true
              required_condition: null
              editable: true
              default_value: null
              calculated: false
              calculation_formula: null
              validation_rules: []
              allowed_values: []
              reference_table: "eu_country_codes"
              cross_form_reference: null
              legacy_mapping:
                database: "intrastat_db"
                table: "declaration_item"
                column: "partner_country"
              ors_mapping:
                table: "mtca_ors.intrastat_item"
                column: "partner_country"
                data_type: "FixedString(2)"

            - field_id: "net_mass_kg"
              field_code: "Line - Col 3"
              field_name_en: "Net Mass (kg)"
              field_name_mt: "Massa Netta (kg)"
              field_description: "Weight of goods in kilograms"
              data_type: "DECIMAL"
              format: "###,###,###.###"
              max_length: null
              precision: 15
              scale: 3
              required: true
              required_condition: null
              editable: true
              default_value: null
              calculated: false
              calculation_formula: null
              validation_rules: []
              allowed_values: []
              reference_table: null
              cross_form_reference: null
              legacy_mapping:
                database: "intrastat_db"
                table: "declaration_item"
                column: "net_mass"
              ors_mapping:
                table: "mtca_ors.intrastat_item"
                column: "net_mass_kg"
                data_type: "Decimal(15,3)"

            - field_id: "statistical_value"
              field_code: "Line - Col 4"
              field_name_en: "Statistical Value"
              field_name_mt: "Valur Statistiku"
              field_description: "Value in EUR (CIF for arrivals, FOB for dispatches)"
              data_type: "CURRENCY_EUR"
              format: "â‚¬###,###,###.00"
              max_length: null
              precision: 15
              scale: 2
              required: true
              required_condition: null
              editable: true
              default_value: null
              calculated: false
              calculation_formula: null
              validation_rules: []
              allowed_values: []
              reference_table: null
              cross_form_reference: null
              legacy_mapping:
                database: "intrastat_db"
                table: "declaration_item"
                column: "stat_value"
              ors_mapping:
                table: "mtca_ors.intrastat_item"
                column: "statistical_value"
                data_type: "Decimal(15,2)"

            - field_id: "transaction_nature"
              field_code: "Line - Col 5"
              field_name_en: "Nature of Transaction"
              field_name_mt: "Natura tat-Transazzjoni"
              field_description: "Type of transaction (purchase, return, etc.)"
              data_type: "CODE"
              format: null
              max_length: 2
              precision: null
              scale: null
              required: true
              required_condition: null
              editable: true
              default_value: "11"
              calculated: false
              calculation_formula: null
              validation_rules: []
              allowed_values:
                - code: "11"
                  description_en: "Outright purchase/sale"
                  description_mt: "Xiri/bejgÄ§ assolut"
                - code: "12"
                  description_en: "Supply for sale on approval"
                  description_mt: "Provvista gÄ§al bejgÄ§ b'approvazzjoni"
                - code: "21"
                  description_en: "Return of goods"
                  description_mt: "Ritorn ta' oÄ¡Ä¡etti"
                - code: "31"
                  description_en: "Processing"
                  description_mt: "IpproÄ‹essar"
                - code: "41"
                  description_en: "Goods on consignment"
                  description_mt: "OÄ¡Ä¡etti fuq konsenja"
              reference_table: "transaction_nature_codes"
              cross_form_reference: null
              legacy_mapping:
                database: "intrastat_db"
                table: "declaration_item"
                column: "transaction_nature"
              ors_mapping:
                table: "mtca_ors.intrastat_item"
                column: "transaction_nature"
                data_type: "FixedString(2)"

      attachments: []

      related_forms:
        - form_code: "VAT_RETURN_ART10"
          relationship_type: "linked"
          relationship_description: "Goods values relate to VAT return"
        - form_code: "RECAPITULATIVE_STATEMENT"
          relationship_type: "linked"
          relationship_description: "Goods supplies to EU customers"

      submission_workflow:
        authentication_required: "NSO Intrastat system login"
        signature_required: false
        payment_integration: false
        acknowledgment_type: "Submission confirmation"

# ============================================================================
# Reference Tables for Priority 3C Forms
# ============================================================================
reference_tables:
  entity_type_codes:
    - code: "IND"
      description_en: "Individual/Sole Trader"
      description_mt: "Individwu/Negozjant Uniku"
    - code: "LTD"
      description_en: "Limited Company"
      description_mt: "Kumpanija Limitata"
    - code: "PRT"
      description_en: "Partnership"
      description_mt: "SÄ§ubija"
    - code: "BRN"
      description_en: "Branch"
      description_mt: "FergÄ§a"
    - code: "OTH"
      description_en: "Other"
      description_mt: "OÄ§ra"

  registration_reason_codes:
    - code: "MAN"
      description_en: "Mandatory - Exceeded Threshold"
      description_mt: "Obbligatorju - QbiÅ¼t il-Limitu"
    - code: "VOL"
      description_en: "Voluntary Registration"
      description_mt: "ReÄ¡istrazzjoni Volontarja"
    - code: "ICA"
      description_en: "Intra-Community Acquisitions"
      description_mt: "Akkwisti Intra-Komunitarji"

  eu_country_codes:
    - code: "AT"
      description_en: "Austria"
    - code: "BE"
      description_en: "Belgium"
    - code: "BG"
      description_en: "Bulgaria"
    - code: "CY"
      description_en: "Cyprus"
    - code: "CZ"
      description_en: "Czech Republic"
    - code: "DE"
      description_en: "Germany"
    - code: "DK"
      description_en: "Denmark"
    - code: "EE"
      description_en: "Estonia"
    - code: "ES"
      description_en: "Spain"
    - code: "FI"
      description_en: "Finland"
    - code: "FR"
      description_en: "France"
    - code: "GR"
      description_en: "Greece"
    - code: "HR"
      description_en: "Croatia"
    - code: "HU"
      description_en: "Hungary"
    - code: "IE"
      description_en: "Ireland"
    - code: "IT"
      description_en: "Italy"
    - code: "LT"
      description_en: "Lithuania"
    - code: "LU"
      description_en: "Luxembourg"
    - code: "LV"
      description_en: "Latvia"
    - code: "NL"
      description_en: "Netherlands"
    - code: "PL"
      description_en: "Poland"
    - code: "PT"
      description_en: "Portugal"
    - code: "RO"
      description_en: "Romania"
    - code: "SE"
      description_en: "Sweden"
    - code: "SI"
      description_en: "Slovenia"
    - code: "SK"
      description_en: "Slovakia"

# ============================================================================
# Cross-Form Relationships Summary
# ============================================================================
form_relationships:
  vat_compliance_chain:
    description: "VAT compliance filing chain"
    flow:
      - source: "VAT_FORM_1"
        target: "VAT_RETURN_ART10"
        relationship: "Registration triggers periodic returns"
      - source: "VAT_RETURN_ART10"
        target: "RECAPITULATIVE_STATEMENT"
        relationship: "IC supplies declared in recapitulative"
      - source: "VAT_RETURN_ART10"
        target: "INTRASTAT"
        relationship: "Goods movements reported"

# ============================================================================
# Legacy to ORS Migration Mapping
# ============================================================================
migration_mapping:
  vat_db:
    tables:
      - legacy_table: "vat_registration"
        ors_table: "mtca_ors.vat_registration"
        key_columns:
          - legacy: "applicant_tin"
            ors: "applicant_tin"
      - legacy_table: "vat_return"
        ors_table: "mtca_ors.vat_return"
        key_columns:
          - legacy: "vat_number"
            ors: "vat_number"
          - legacy: "period_from"
            ors: "period_from"
      - legacy_table: "recapitulative"
        ors_table: "mtca_ors.recapitulative_statement"
        key_columns:
          - legacy: "vat_number"
            ors: "vat_number"
          - legacy: "period_year"
            ors: "period_year"
          - legacy: "period_month"
            ors: "period_month"
  intrastat_db:
    tables:
      - legacy_table: "declaration"
        ors_table: "mtca_ors.intrastat_declaration"
        key_columns:
          - legacy: "vat_number"
            ors: "vat_number"
          - legacy: "declaration_type"
            ors: "declaration_type"
          - legacy: "reference_year"
            ors: "reference_year"
          - legacy: "reference_month"
            ors: "reference_month"
