# TA-RDM Source Ingestion Configuration
# Copy this file to .env and update with your environment-specific values

# ==============================================================================
# MySQL L2 Canonical Database Configuration
# ==============================================================================
# Target database for TA-RDM canonical model (Layer 2)
L2_DB_HOST=localhost
L2_DB_PORT=3308
L2_DB_USER=ta_user
L2_DB_PASSWORD=your_secure_password_here

# Connection Pool Settings
L2_DB_POOL_SIZE=5
L2_DB_POOL_RECYCLE=3600
L2_DB_CONNECT_TIMEOUT=10

# ==============================================================================
# MySQL Configuration Database
# ==============================================================================
# Metadata database for ingestion configuration
# Can be same instance as L2, different schema
CONFIG_DB_HOST=localhost
CONFIG_DB_PORT=3308
CONFIG_DB_USER=ta_user
CONFIG_DB_PASSWORD=your_secure_password_here
CONFIG_DB_DATABASE=ta_rdm_config

# Connection Pool Settings
CONFIG_DB_POOL_SIZE=3
CONFIG_DB_POOL_RECYCLE=3600

# ==============================================================================
# RAMIS Source Database Configuration (SQL Server)
# ==============================================================================
# Source database for RAMIS data
RAMIS_DB_HOST=ramis-server.example.com
RAMIS_DB_PORT=1433
RAMIS_DB_USER=ramis_reader
RAMIS_DB_PASSWORD=your_ramis_password_here
RAMIS_DB_DATABASE=RAMIS

# SQL Server Options
RAMIS_DB_DRIVER=pymssql
# Alternative: pyodbc (requires ODBC driver)
# RAMIS_DB_DRIVER=ODBC Driver 17 for SQL Server

# Connection timeout
RAMIS_DB_TIMEOUT=30

# ==============================================================================
# MySQL Staging Database Configuration
# ==============================================================================
# Staging layer (Layer 1) - can be same instance as L2
STAGING_DB_HOST=localhost
STAGING_DB_PORT=3308
STAGING_DB_USER=ta_user
STAGING_DB_PASSWORD=your_secure_password_here
STAGING_DB_DATABASE=staging

# ==============================================================================
# Logging Configuration
# ==============================================================================
LOG_LEVEL=INFO
# Options: DEBUG, INFO, WARNING, ERROR, CRITICAL

# Log file path (optional - leave empty for console only)
LOG_FILE_PATH=logs/ingestion.log

# Enable colored console output
LOG_COLORED_OUTPUT=true

# Log SQL queries (DEBUG mode)
LOG_SQL_QUERIES=false

# ==============================================================================
# ETL Configuration
# ==============================================================================
# Batch size for bulk inserts (rows per batch)
ETL_BATCH_SIZE=10000

# Enable dry run mode (no commits)
ETL_DRY_RUN=false

# Enable transaction rollback on errors
ETL_ROLLBACK_ON_ERROR=true

# Maximum retry attempts for failed operations
ETL_MAX_RETRIES=3

# Retry delay in seconds
ETL_RETRY_DELAY=5

# ==============================================================================
# Data Quality Configuration
# ==============================================================================
# Data quality validation mode
DQ_VALIDATION_MODE=REJECT
# Options: REJECT (fail on error), WARN (log warning), FIX (auto-correct)

# Log data quality violations
DQ_LOG_VIOLATIONS=true

# Maximum violations to log per run
DQ_MAX_VIOLATIONS_LOG=1000

# ==============================================================================
# Incremental Load Configuration
# ==============================================================================
# Enable incremental loading
INCREMENTAL_LOAD_ENABLED=true

# Timestamp column for incremental loads
INCREMENTAL_TIMESTAMP_COLUMN=last_modified_date

# Watermark table for tracking last load
INCREMENTAL_WATERMARK_TABLE=ta_rdm_config.etl_watermarks

# ==============================================================================
# Performance Configuration
# ==============================================================================
# Enable parallel processing
PARALLEL_PROCESSING=false

# Number of parallel workers
PARALLEL_WORKERS=4

# Memory limit for data transformations (MB)
MEMORY_LIMIT_MB=2048

# ==============================================================================
# Notification Configuration (Optional)
# ==============================================================================
# Send email notifications on failure
NOTIFY_ON_FAILURE=false
NOTIFY_EMAIL_FROM=etl@example.com
NOTIFY_EMAIL_TO=admin@example.com
NOTIFY_SMTP_HOST=smtp.example.com
NOTIFY_SMTP_PORT=587

# ==============================================================================
# Airflow Integration (Optional - Future Enhancement)
# ==============================================================================
# Airflow DAG settings
AIRFLOW_DAG_ID=ta_rdm_source_ingestion
AIRFLOW_SCHEDULE=0 2 * * *
# Cron: Daily at 2:00 AM

# ==============================================================================
# Notes
# ==============================================================================
# - Keep this file secure and do not commit .env to version control
# - Different environments (dev/test/prod) should have separate .env files
# - Validate configuration with: python scripts/test_connections.py
# - For production, consider using environment variables or secrets manager
